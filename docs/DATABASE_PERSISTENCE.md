# æ•°æ®æŒä¹…åŒ–é…ç½®è¯´æ˜ ğŸ’¾

## âœ… é—®é¢˜è§£å†³

### ä¹‹å‰çš„é—®é¢˜
- æ¯æ¬¡å¯åŠ¨æœåŠ¡æ—¶ï¼ŒPostgreSQLæ•°æ®åº“æ•°æ®ä¼šè¢«æ¸…ç©º
- å®¹å™¨é‡å¯åæ‰€æœ‰æ”¶é›†çš„æ–°é—»æ•°æ®ä¸¢å¤±
- éœ€è¦é‡æ–°è¿è¡Œæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬

### âœ… è§£å†³æ–¹æ¡ˆ

#### 1. PostgreSQLæ•°æ®æŒä¹…åŒ–
åœ¨`docker-compose.yml`ä¸­æ·»åŠ äº†å·æŒ‚è½½ï¼š

```yaml
postgres:
  image: postgres:16
  volumes:
    - postgres_data:/var/lib/postgresql/data  # æ•°æ®æŒä¹…åŒ–
  # ... å…¶ä»–é…ç½®

volumes:
  postgres_data:  # å®šä¹‰æ•°æ®å·
```

#### 2. æ™ºèƒ½æ•°æ®åº“åˆå§‹åŒ–
åœ¨`Makefile`ä¸­æ·»åŠ äº†æ™ºèƒ½åˆå§‹åŒ–é€»è¾‘ï¼š

```makefile
# æ™ºèƒ½æ•°æ®åº“åˆå§‹åŒ–ï¼ˆä»…å½“è¡¨ä¸å­˜åœ¨æ—¶æ‰è¿è¡Œï¼‰
migrate-if-needed:
	@if ! docker exec ai-invest-postgres-1 psql -U finance -d finance -c "SELECT 1 FROM articles LIMIT 1;" >/dev/null 2>&1; then \
		echo "åˆå§‹åŒ–æ•°æ®åº“schema..."; \
		docker exec -i ai-invest-postgres-1 psql -U finance -d finance < src/db/schema.sql; \
	else \
		echo "æ•°æ®åº“å·²å­˜åœ¨ï¼Œè·³è¿‡åˆå§‹åŒ–"; \
	fi
```

#### 3. å¢å¼ºç‰ˆRSS Produceré›†æˆ
- é»˜è®¤ä½¿ç”¨`enhanced_rss_producer`è€Œä¸æ˜¯åŸç‰ˆ
- æ”¯æŒå¤šä¼˜å…ˆçº§RSSæºæ”¶é›†
- æ›´å¥½çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

### ğŸ“Š éªŒè¯ç»“æœ

#### æµ‹è¯•æ­¥éª¤
1. å¯åŠ¨æœåŠ¡å¹¶æ”¶é›†æ•°æ®ï¼š`make start`
2. æ”¶é›†äº†**100ç¯‡æ–‡ç« **
3. åœæ­¢æ‰€æœ‰æœåŠ¡ï¼š`make stop`  
4. é‡æ–°å¯åŠ¨æœåŠ¡ï¼š`make start`
5. æ£€æŸ¥æ•°æ®ï¼šä»ç„¶æœ‰**100ç¯‡æ–‡ç« ** âœ…

#### è§‚å¯Ÿåˆ°çš„è¡Œä¸º
- âœ… ç¬¬ä¸€æ¬¡å¯åŠ¨ï¼šæ˜¾ç¤º"åˆå§‹åŒ–æ•°æ®åº“schema..."
- âœ… é‡å¯åï¼šæ˜¾ç¤º"æ•°æ®åº“å·²å­˜åœ¨ï¼Œè·³è¿‡åˆå§‹åŒ–"
- âœ… æ•°æ®å®Œå…¨ä¿ç•™ï¼Œæ— æ•°æ®ä¸¢å¤±

## ğŸ› ï¸ å¯ç”¨å‘½ä»¤

### æ­£å¸¸æ“ä½œ
```bash
make start    # å¯åŠ¨æœåŠ¡ï¼ˆæ™ºèƒ½åˆå§‹åŒ–ï¼‰
make stop     # åœæ­¢æœåŠ¡
make restart  # é‡å¯æœåŠ¡
make status   # æ£€æŸ¥çŠ¶æ€
```

### æ•°æ®åº“ç®¡ç†
```bash
make migrate-if-needed  # ä»…åœ¨éœ€è¦æ—¶åˆå§‹åŒ–æ•°æ®åº“
make migrate           # å¼ºåˆ¶è¿è¡Œæ•°æ®åº“åˆå§‹åŒ–
make reset-db          # âš ï¸ æ¸…ç©ºæ‰€æœ‰æ•°æ®å¹¶é‡æ–°åˆå§‹åŒ–ï¼ˆéœ€ç¡®è®¤ï¼‰
```

### æœåŠ¡æ§åˆ¶
```bash
make prod-enhanced  # å•ç‹¬å¯åŠ¨å¢å¼ºç‰ˆRSS Producer
make api           # å•ç‹¬å¯åŠ¨APIæœåŠ¡
make parse         # å•ç‹¬å¯åŠ¨è§£æå™¨
make db            # å•ç‹¬å¯åŠ¨æ•°æ®åº“æ¶ˆè´¹è€…
```

## ğŸ¯ æ•°æ®ä¿æŠ¤ç‰¹æ€§

### ğŸ”’ è‡ªåŠ¨ä¿æŠ¤
- **å®¹å™¨é‡å¯**ï¼šæ•°æ®è‡ªåŠ¨ä¿ç•™
- **ç³»ç»Ÿé‡å¯**ï¼šæ•°æ®æ°¸ä¹…å­˜å‚¨åœ¨Dockerå·ä¸­
- **æ„å¤–å…³é—­**ï¼šPostgreSQLæ•°æ®ä¸ä¼šä¸¢å¤±

### âš ï¸ æ•°æ®æ¸…ç©ºåœºæ™¯
æ•°æ®åªä¼šåœ¨ä»¥ä¸‹æƒ…å†µä¸‹è¢«æ¸…ç©ºï¼š
- æ‰‹åŠ¨è¿è¡Œ`make reset-db`
- åˆ é™¤Dockerå·ï¼š`docker volume rm ai-invest_postgres_data`
- æ‰‹åŠ¨åˆ é™¤è¡¨æˆ–æ•°æ®

### ğŸš€ æœ€ä½³å®è·µ
- ä½¿ç”¨`make start`è¿›è¡Œæ­£å¸¸å¯åŠ¨
- å®šæœŸæ£€æŸ¥`make status`ç¡®è®¤æœåŠ¡å¥åº·
- éœ€è¦æ¸…ç©ºæ•°æ®æ—¶æ˜ç¡®ä½¿ç”¨`make reset-db`
- é‡è¦æ•°æ®å¯ä»¥é€šè¿‡APIå¯¼å‡ºå¤‡ä»½

## ğŸ“ˆ æ€§èƒ½å½±å“

### å­˜å‚¨éœ€æ±‚
- **Dockerå·**ï¼šéšæ•°æ®å¢é•¿ï¼Œé¢„è®¡1-10GB/æœˆ
- **æ•°æ®è¡¨**ï¼š100-1000ç¯‡æ–‡ç« /å¤©ï¼Œçº¦1-10MB/å¤©

### å¯åŠ¨æ—¶é—´
- **é¦–æ¬¡å¯åŠ¨**ï¼šéœ€è¦è¿è¡Œschemaåˆå§‹åŒ–ï¼ˆ+3-5ç§’ï¼‰
- **åç»­å¯åŠ¨**ï¼šè·³è¿‡åˆå§‹åŒ–ï¼Œå¯åŠ¨æ›´å¿«ï¼ˆ-3-5ç§’ï¼‰

---
*é…ç½®æ›´æ–°ï¼š2025-10-31*  
*æµ‹è¯•éªŒè¯ï¼šâœ… æ•°æ®æŒä¹…åŒ–æ­£å¸¸å·¥ä½œ*